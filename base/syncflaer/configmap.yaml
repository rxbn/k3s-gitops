---
apiVersion: v1
kind: ConfigMap
metadata:
  name: syncflaer
  namespace: syncflaer
data:
  config.yml: |2
    ---
    notifications:
      slack:
        webhookURL: env:SLACK_WEBHOOK_URL

    traefikInstances:
      - name: k3s
        url: http://traefik.traefik.svc.cluster.local:9000
        ignoredRules:
          - local.${BASE_DOMAIN}
          - dev.${BASE_DOMAIN}

    additionalRecords:
      - name: teslamate-gcp.${BASE_DOMAIN}
        type: A
        ttl: 1
        content: ${GCP_TESLAMATE_INSTANCE_IP}
        proxied: true
      - name: teslamate-grafana-gcp.${BASE_DOMAIN}
        type: A
        ttl: 1
        content: ${GCP_TESLAMATE_INSTANCE_IP}
        proxied: true
      - name: teslamate.srv.${BASE_DOMAIN}
        type: A
        ttl: 1
        content: ${GCP_TESLAMATE_INSTANCE_IP}
        proxied: false
      - name: vpn.${BASE_DOMAIN}
        ttl: 120
        proxied: false

    cloudflare:
      apiToken: env:CF_API_TOKEN
      zoneNames:
        - ${BASE_DOMAIN}
      deleteGrace: 5
      defaults:
        proxied: true
