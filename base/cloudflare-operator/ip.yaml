---
apiVersion: cf.containeroo.ch/v1beta1
kind: IP
metadata:
  name: ${BASE_DOMAIN/./-}-v4
spec:
  type: dynamic
  ipSources:
    - url: https://ifconfig.me/ip
    - url: https://ipecho.net/plain
    - url: https://myip.is/ip/
    - url: https://checkip.amazonaws.com
    - url: https://api.ipify.org
---
apiVersion: cf.containeroo.ch/v1beta1
kind: IP
metadata:
  name: ${BASE_DOMAIN/./-}-v6
spec:
  type: static
  address: ${METALLB_TRAEFIK_ADDRESS_POOL_V6%/128}
---
apiVersion: cf.containeroo.ch/v1beta1
kind: IP
metadata:
  name: teslamate-v4
spec:
  type: dynamic
  ipSources:
    - url: https://api.hetzner.cloud/v1/servers
      requestHeaders:
        Accept: application/json
      requestHeadersSecretRef:
        name: hetzner-cloud-api-key
        namespace: cloudflare-operator
      responseJSONPath: '{.servers[?(@.name=="teslamate.srv.${BASE_DOMAIN}")].public_net.ipv4.ip}'
---
apiVersion: cf.containeroo.ch/v1beta1
kind: IP
metadata:
  name: teslamate-v6
spec:
  type: static
  address: ${HCLOUD_TESLAMATE_V6}
---
apiVersion: cf.containeroo.ch/v1beta1
kind: IP
metadata:
  name: checkmk-v4
spec:
  type: dynamic
  ipSources:
    - url: https://api.hetzner.cloud/v1/servers
      requestHeaders:
        Accept: application/json
      requestHeadersSecretRef:
        name: hetzner-cloud-api-key
        namespace: cloudflare-operator
      responseJSONPath: '{.servers[?(@.name=="checkmk.srv.${BASE_DOMAIN}")].public_net.ipv4.ip}'
---
apiVersion: cf.containeroo.ch/v1beta1
kind: IP
metadata:
  name: checkmk-v6
spec:
  type: static
  address: ${HCLOUD_CHECKMK_V6}
---
apiVersion: cf.containeroo.ch/v1beta1
kind: IP
metadata:
  name: keycloak-v4
spec:
  type: dynamic
  ipSources:
    - url: https://api.hetzner.cloud/v1/servers
      requestHeaders:
        Accept: application/json
      requestHeadersSecretRef:
        name: hetzner-cloud-api-key
        namespace: cloudflare-operator
      responseJSONPath: '{.servers[?(@.name=="keycloak.srv.${BASE_DOMAIN}")].public_net.ipv4.ip}'
---
apiVersion: cf.containeroo.ch/v1beta1
kind: IP
metadata:
  name: keycloak-v6
spec:
  type: static
  address: ${HCLOUD_KEYCLOAK_V6}
